(function(u,g){typeof exports=="object"&&typeof module!="undefined"?g(exports):typeof define=="function"&&define.amd?define(["exports"],g):(u=typeof globalThis!="undefined"?globalThis:u||self,g(u.VueUeditorWrap={}))})(this,function(u){"use strict";/**
* @vue/shared v3.4.23
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const g=[],N=()=>{},j=()=>!1,V=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),O=Object.assign,f=Array.isArray,h=t=>typeof t=="function",d=t=>typeof t=="string",m=t=>t!==null&&typeof t=="object";let S;const A=()=>S||(S=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});function E(t){if(f(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],i=d(s)?B(s):E(s);if(i)for(const o in i)e[o]=i[o]}return e}else if(d(t)||m(t))return t}const M=/;(?![^(]*\))/g,D=/:([^]+)/,P=/\/\*[^]*?\*\//g;function B(t){const e={};return t.replace(P,"").split(M).forEach(n=>{if(n){const s=n.split(D);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function w(t){let e="";if(d(t))e=t;else if(f(t))for(let n=0;n<t.length;n++){const s=w(t[n]);s&&(e+=s+" ")}else if(m(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}/**
* @vue/reactivity v3.4.23
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function T(t){return t?!!t.__v_raw:!1}function L(t){return!!(t&&t.__v_isRef===!0)}/**
* @vue/runtime-core v3.4.23
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let _=null,z=null;const G=Symbol.for("v-ndc"),$=t=>t.__isSuspense;function W(){return{app:null,config:{isNativeTag:j,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}const H=Object.create(null),I=t=>Object.getPrototypeOf(t)===H,q=t=>t.__isTeleport,k=Symbol.for("v-fgt"),Y=Symbol.for("v-txt"),K=Symbol.for("v-cmt"),p=[];let a=null;function J(t=!1){p.push(a=t?null:[])}function Q(){p.pop(),a=p[p.length-1]||null}function X(t){return t.dynamicChildren=a||g,Q(),a&&a.push(t),t}function Z(t,e,n,s,i,o){return X(x(t,e,n,s,i,o,!0))}function v(t){return t?t.__v_isVNode===!0:!1}const U=({key:t})=>t!=null?t:null,C=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?d(t)||L(t)||h(t)?{i:_,r:t,k:e,f:!!n}:t:null);function x(t,e=null,n=null,s=0,i=null,o=t===k?0:1,l=!1,r=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&U(e),ref:e&&C(e),scopeId:z,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:_};return r?(b(c,n),o&128&&t.normalize(c)):n&&(c.shapeFlag|=d(n)?8:16),!l&&a&&(c.patchFlag>0||o&6)&&c.patchFlag!==32&&a.push(c),c}const tt=et;function et(t,e=null,n=null,s=0,i=null,o=!1){if((!t||t===G)&&(t=K),v(t)){const r=y(t,e,!0);return n&&b(r,n),!o&&a&&(r.shapeFlag&6?a[a.indexOf(t)]=r:a.push(r)),r.patchFlag|=-2,r}if(ot(t)&&(t=t.__vccOpts),e){e=nt(e);let{class:r,style:c}=e;r&&!d(r)&&(e.class=w(r)),m(c)&&(T(c)&&!f(c)&&(c=O({},c)),e.style=E(c))}const l=d(t)?1:$(t)?128:q(t)?64:m(t)?4:h(t)?2:0;return x(t,e,n,s,i,l,o,!0)}function nt(t){return t?T(t)||I(t)?O({},t):t:null}function y(t,e,n=!1){const{props:s,ref:i,patchFlag:o,children:l}=t,r=e?st(s||{},e):s;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:r,key:r&&U(r),ref:e&&e.ref?n&&i?f(i)?i.concat(C(e)):[i,C(e)]:C(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:l,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==k?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&y(t.ssContent),ssFallback:t.ssFallback&&y(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce}}function it(t=" ",e=0){return tt(Y,null,t,e)}function b(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(f(e))n=16;else if(typeof e=="object")if(s&65){const i=e.default;i&&(i._c&&(i._d=!1),b(t,i()),i._c&&(i._d=!0));return}else{n=32;const i=e._;!i&&!I(e)?e._ctx=_:i===3&&_&&(_.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else h(e)?(e={default:e,_ctx:_},n=32):(e=String(e),s&64?(n=16,e=[it(e)]):n=8);t.children=e,t.shapeFlag|=n}function st(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const i in s)if(i==="class")e.class!==s.class&&(e.class=w([e.class,s.class]));else if(i==="style")e.style=E([e.style,s.style]);else if(V(i)){const o=e[i],l=s[i];l&&o!==l&&!(f(o)&&o.includes(l))&&(e[i]=o?[].concat(o,l):l)}else i!==""&&(e[i]=s[i])}return e}W();{const t=A(),e=(n,s)=>{let i;return(i=t[n])||(i=t[n]=[]),i.push(s),o=>{i.length>1?i.forEach(l=>l(o)):i[0](o)}};e("__VUE_INSTANCE_SETTERS__",n=>n),e("__VUE_SSR_SETTERS__",n=>n)}function ot(t){return h(t)&&"__vccOpts"in t}var _t="",rt=(t,e)=>{const n=t.__vccOpts||t;for(const[s,i]of e)n[s]=i;return n};class lt{constructor(){this.listeners={}}on(e,n){this.listeners[e]===void 0&&(this.listeners[e]=[]),this.listeners[e].push(n)}emit(e){this.listeners[e]&&this.listeners[e].forEach(n=>n())}}const ct={name:"vue-ueditor-wrap",data(){return{id:"vuEditor3_"+Math.round(Math.random()*100),editor:null,defaultConfig:{UEDITOR_HOME_URL:"/static/plugins/ueditor/1.4.3.3/",enableAutoSave:!1}}},props:{modelValue:{type:String,default:"\u6682\u65E0\u6570\u636E"},config:{type:Object,default:function(){return{}}},configPath:{type:String,default:"/static/plugins/ueditor/1.4.3.3/ueditor.config.js"},init:{type:Function,default:function(){return()=>{}}},destroy:Boolean},computed:{mixedConfig(){return Object.assign({},this.defaultConfig,this.config)}},methods:{registerButton:({name:t,icon:e,tip:n,handler:s,UE:i=window.UE})=>{i.registerUI(t,(o,l)=>{o.registerCommand(l,{execCommand:()=>{s(o,l)}});const r=new i.ui.Button({name:l,title:n,cssRules:`background-image: url(${e}) !important;background-size: cover;`,onclick(){o.execCommand(l)}});return o.addListener("selectionchange",()=>{const c=o.queryCommandState(l);c===-1?(r.setDisabled(!0),r.setChecked(!1)):(r.setDisabled(!1),r.setChecked(c))}),r})},_beforeInitEditor(t){!!window.UE&&!!window.UEDITOR_CONFIG&&Object.keys(window.UEDITOR_CONFIG).length!==0&&!!window.UE.getEditor?this._initEditor(t):this._loadScripts().then(()=>this._initEditor(t))},_initEditor(t){this.$nextTick(()=>{this.init(),this.editor=window.UE.getEditor(this.id,this.mixedConfig),this.editor.addListener("ready",()=>{this.$emit("ready",this.editor),this.editor.setContent(t),this.editor.execCommand("serverparam",function(){return{auth_token:localStorage.getItem("token")}}),this.editor.queryCommandValue("serverparam"),this.editor.addListener("contentChange",()=>{setTimeout(()=>{this.$emit("update:modelValue",this.editor.getContent()),this.$emit("puretxt",this.editor.getContentTxt())},100)})})})},_loadScripts(){return window.loadEnv?new Promise(t=>{window.loadEnv.on("scriptsLoaded",function(){t()})}):(window.loadEnv=new lt,new Promise(t=>{this._loadConfig().then(()=>this._loadCore()).then(()=>{window.loadEnv.emit("scriptsLoaded"),t()})}))},_loadConfig(){return new Promise(t=>{if(!!window.UE&&!!window.UEDITOR_CONFIG&&Object.keys(window.UEDITOR_CONFIG).length!==0){t();return}const e=document.createElement("script");e.type="text/javascript",e.src=this.configPath,document.getElementsByTagName("head")[0].appendChild(e),e.onload=function(){!!window.UE&&!!window.UEDITOR_CONFIG&&Object.keys(window.UEDITOR_CONFIG).length!==0?t():console.error("UE\u914D\u7F6E\u6587\u4EF6\u52A0\u8F7D\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u914D\u7F6E\u6587\u4EF6\u8DEF\u5F84\u662F\u5426\u6B63\u786E\u3002")}})},_loadCore(){return new Promise(t=>{if(!!window.UE&&!!window.UE.getEditor)return t();const e=document.createElement("script");e.type="text/javascript",e.src=this.mixedConfig.UEDITOR_HOME_URL+"ueditor.all.js",document.getElementsByTagName("head")[0].appendChild(e),e.onload=function(){!!window.UE&&!!window.UE.getEditor&&t()}})},_setContent(t){t===this.editor.getContent()||this.editor.setContent(t)}},beforeUnmount(){this.destroy&&this.editor&&this.editor.destroy&&(this.editor.destroy(),this.editor=null)},watch:{modelValue:{handler(t){this.editor?this._setContent(t):this._beforeInitEditor(t)},immediate:!0}}},at=["id"];function ut(t,e,n,s,i,o){return J(),Z("div",{id:i.id,class:"editor"},null,8,at)}var F=rt(ct,[["render",ut],["__scopeId","data-v-c4dd8baa"]]);const dt=[F],R=t=>{dt.forEach(e=>{e.install=n=>{n.component(e.name,e),console.log("\u6CE8\u518C",e.name)},t.use((e.name,e))})};var ft={install:R};u.VueUeditorWrap=F,u.default=ft,u.install=R,Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
