(function(t,a){typeof exports=="object"&&typeof module<"u"?a(exports,require("axios"),require("vue"),require("vue3-sfc-loader"),require("element-plus")):typeof define=="function"&&define.amd?define(["exports","axios","vue","vue3-sfc-loader","element-plus"],a):(t=typeof globalThis<"u"?globalThis:t||self,a(t.MsElForm={},t.axios,t.Vue,t.vue3SfcLoader))})(this,function(exports,axios,Vue,vue3SfcLoader){"use strict";function _interopNamespaceDefault(t){const a=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const n in t)if(n!=="default"){const u=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(a,n,u.get?u:{enumerable:!0,get:()=>t[n]})}}return a.default=t,Object.freeze(a)}const Vue__namespace=_interopNamespaceDefault(Vue),msIcon_vue_vue_type_style_index_0_scoped_15364228_lang="",_export_sfc=(t,a)=>{const n=t.__vccOpts||t;for(const[u,o]of a)n[u]=o;return n},_sfc_main$2={name:"ms-icon",props:["value"],data:function(){return{dialogVisible:!1,icons:[],mark:-1}},methods:{openIconList:function(){this.dialogVisible=!0},selected:function(t,a){this.$emit("update:value","icon-"+t),this.mark=a},select:function(){this.dialogVisible=!1},iconList:function(){var t=this;axios.create().get(ms.base+"/static/plugins/iconfont/1.0.0/iconfont.json",{}).then(function(a){t.icons=a.data.glyphs}).catch(function(a){})}},created:function(){this.iconList()}},_hoisted_1$2={class:"list"},_hoisted_2=["onClick"];function _sfc_render$2(t,a,n,u,o,d){const s=Vue.resolveComponent("el-button"),r=Vue.resolveComponent("el-input"),c=Vue.resolveComponent("el-scrollbar"),m=Vue.resolveComponent("el-main"),V=Vue.resolveComponent("el-dialog");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(r,{modelValue:n.value,disabled:""},{prepend:Vue.withCtx(()=>[Vue.createElementVNode("i",{style:{"line-height":"1"},class:Vue.normalizeClass(["iconfont",n.value])},null,2)]),append:Vue.withCtx(()=>[Vue.createVNode(s,{class:"el-icon-search",onClick:d.openIconList},null,8,["onClick"])]),_:1},8,["modelValue"]),Vue.createVNode(V,{title:"选择图标",modelValue:t.dialogVisible,"onUpdate:modelValue":a[1]||(a[1]=i=>t.dialogVisible=i),width:"80%",class:"ms-Icons","close-on-click-modal":!1,"append-to-body":""},{footer:Vue.withCtx(()=>[Vue.createElementVNode("div",null,[Vue.createVNode(s,{size:"default",onClick:a[0]||(a[0]=i=>t.dialogVisible=!1)},{default:Vue.withCtx(()=>[Vue.createTextVNode("取 消")]),_:1}),Vue.createVNode(s,{size:"default",type:"primary",onClick:d.select},{default:Vue.withCtx(()=>[Vue.createTextVNode("确 定")]),_:1},8,["onClick"])])]),default:Vue.withCtx(()=>[Vue.createVNode(m,null,{default:Vue.withCtx(()=>[Vue.createVNode(c,{style:{height:"100%"}},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",_hoisted_1$2,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(t.icons,(i,p)=>(Vue.openBlock(),Vue.createElementBlock("div",{key:p,class:Vue.normalizeClass(t.mark==p?"select":""),onClick:v=>d.selected(i.font_class,p)},[Vue.createElementVNode("i",{class:Vue.normalizeClass(["iconfont","icon-"+i.font_class])},null,2),Vue.createTextVNode("icon-"+Vue.toDisplayString(i.font_class),1)],10,_hoisted_2))),128))])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const MsIcon=_export_sfc(_sfc_main$2,[["render",_sfc_render$2],["__scopeId","data-v-15364228"]]),msMdiyForm_vue_vue_type_style_index_0_scoped_fd54ea7e_lang="",_sfc_main$1={props:{modelId:String,id:String,type:"",disabled:!1},name:"ms-mdiy-form",data:function(){return{loading:!1,modelComp:null,searchJson:null,mdiyForm:{update:{url:ms.manager+"/mdiy/form/data/update.do",params:{}},save:{url:ms.manager+"/mdiy/form/data/save.do",params:{}},get:{url:ms.manager+"/mdiy/form/data/getData.do",params:{}}},mdiyConfig:{update:{url:ms.manager+"/mdiy/config/data/update.do",params:{}},save:{url:ms.manager+"/mdiy/config/data/update.do",params:{}},get:{url:ms.manager+"/mdiy/config/data/get.do",params:{}}},mdiyModel:{update:{url:ms.manager+"/mdiy/model/data/update.do",params:{}},save:{url:ms.manager+"/mdiy/model/data/save.do",params:{}},get:{url:ms.manager+"/mdiy/model/data.do",params:{}}},mdiyTag:{update:{url:ms.manager+"/mdiy/tag/globalTag/update.do",params:{}},save:{url:ms.manager+"/mdiy/tag/globalTag/update.do",params:{}},get:{url:ms.manager+"/mdiy/tag/globalTag/get.do",params:{}}},qa:{update:{url:ms.manager+"/qa/data/update.do",params:{}},save:{url:ms.manager+"/qa/data/save.do",params:{}},get:{url:ms.manager+"/qa/data/getData.do",params:{}}},formURL:null}},watch:{modelId:function(t){this.render()}},methods:{getForm:function(){return this.$refs.form},render:function(){let that=this;that.loading=!0;let getUrl="/mdiy/form/get.do";that.type==="form"?this.formURL=this.mdiyForm:that.type==="config"?(this.formURL=this.mdiyConfig,getUrl="/mdiy/config/get.do"):that.type==="model"?(this.formURL=this.mdiyModel,getUrl="/mdiy/model/get.do"):that.type==="tag"?(this.formURL=this.mdiyTag,getUrl="/mdiy/tag/globalTag/getModel.do"):that.type==="qa"&&(this.formURL=this.qa,getUrl="/qa/qa/get.do");const render=t=>{try{const a={moduleCache:{vue:Vue__namespace},async getFile(){return t},addStyle(u){const o=Object.assign(document.createElement("style"),{textContent:u}),d=document.head.getElementsByTagName("style")[0]||null;document.head.insertBefore(o,d)}},n=Vue.defineAsyncComponent(()=>vue3SfcLoader.loadModule("modelComp.vue",a));that.modelComp=Vue.shallowRef(n),that.loading=!1}catch{}};ms.http.get(ms.manager+getUrl,{id:this.modelId}).then(function(res){if(res.result&&res.data){var data=JSON.parse(res.data.modelJson);that.searchJson=eval(data.searchJson);var data=JSON.parse(res.data.modelJson),html=data.html,script="";data.script&&(script="<script>"+data.script.replace(`\r
});\r
`,`\r
}`)+"<\/script>");let code=html+script;code=code.replace('var custom_model = Vue.component("custom-model",{',"export default{"),code=code.replace("el: '#custom-model',",""),that.formURL.get.params=Object.assign({id:that.id,linkId:that.id},that.formURL.get.params),!that.id&&that.type!="config"&&(code=code.replace("that.get();","")),code=code.replace(/\}\);\s*<\/script>/,"};<\/script>"),code=code.replace("save:function(callback) {","save:function(callback) { debugger;"),code=code.replace("modelId:0,","formURL:"+JSON.stringify(that.formURL)+`,
 modelId:'`+res.data.id+"',"),that.disabled&&(code=code.replace("disabled:false,","disabled:"+that.disabled+",")),window.ms.debug,render(code)}else alert(res.msg)})}},created:function(){this.render()}},_hoisted_1$1={style:{height:"100%"}};function _sfc_render$1(t,a,n,u,o,d){const s=Vue.resolveDirective("loading");return Vue.withDirectives((Vue.openBlock(),Vue.createElementBlock("div",_hoisted_1$1,[(Vue.openBlock(),Vue.createBlock(Vue.resolveDynamicComponent(t.modelComp),{ref:"form"},null,512))])),[[s,t.loading]])}const MsMdiyForm=_export_sfc(_sfc_main$1,[["render",_sfc_render$1],["__scopeId","data-v-fd54ea7e"]]),msSearch_vue_vue_type_style_index_0_scoped_2a385fa6_lang="",_sfc_main={name:"ms-search",props:{isModel:{type:Boolean,default:!1},searchJson:{type:Array,default:[]},searchKey:{type:String}},inject:["searchParent"],computed:{$searchParent:function(){return this.isModel?this.searchParent.$refs.modelForm.$refs.form:this.searchParent},availableOptions(){var t=this;return t.searchJson.filter(function(a,n){return t.selectedList.indexOf(n)===-1})}},watch:{visible:function(t){var u;var a=!1;if(sessionStorage.getItem(this.searchKey))try{var n=JSON.parse(sessionStorage.getItem(this.searchKey));a=((u=n.form)==null?void 0:u.sqlWhere)!==void 0}catch{}t&&!a&&(this.list=[],this.selectedList=[])}},data:function(){return{visible:!1,list:[],selectedList:[]}},methods:{delField:function(t){this.list.splice(t,1),this.selectedList.splice(t,1)},select:function(t){var a=this.availableOptions[t];this.list.push(Object.assign({},a,{value:a.type==="switch"?!1:""}));var n=this.searchJson.findIndex(function(u){return u===a});this.selectedList.push(n)},dateChange:function(t){t.el==="range"?t.value=[]:Array.isArray(t.value)&&(t.value=t.value[0])},cascaderTreeDatas:function(t){return ms.util.treeData(this.$searchParent[t.model+"Options"],this.$searchParent[t.model+"Props"].value,t.extend.parentId,"children")},search:function(){var t=this;this.visible=!1;var a=[];let n=JSON.parse(JSON.stringify(t.list));for(var u=0;u<n.length;u++){var o=n[u];if(o.el==="empty"||o.el==="notempty"){o.value="",a.push(o);continue}if(!(!o.value||o.value.length===0))switch(o.type){case"province_id":o.value.forEach((m,V)=>{var i;V===0?i=o.field:i=o.attachFields[V-1],a.push({action:"and",field:i,el:"eq",value:m,type:"province_id"})});continue;case"checkbox":case"select":if(o.multiple){for(var d=t.$searchParent[o.model+"Options"],s={},r=0;r<d.length;r++){var c=d[r];s[c.value]=r}o.value.sort(function(m,V){return s[m]-s[V]}),o.value=o.value.join(","),a.push(o)}else a.push(o);continue;case"date":(o.fmt==="YYYY"||o.fmt==="YYYY-MM")&&(Array.isArray(o.value)?o.value=o.value.map(m=>ms.util.date.fmt(m,"YYYY-MM-DD")):o.value=ms.util.date.fmt(o.value,"YYYY-MM-DD")),a.push(o);continue;case"switch":o.value=!!o.value,a.push(o);continue;case"input":case"input-number":default:a.push(o)}}t.$emit("search",a)},save:function(){}}},_hoisted_1={class:"dialog-footer"};function _sfc_render(t,a,n,u,o,d){const s=Vue.resolveComponent("el-button"),r=Vue.resolveComponent("el-option"),c=Vue.resolveComponent("el-select"),m=Vue.resolveComponent("el-form-item"),V=Vue.resolveComponent("el-form"),i=Vue.resolveComponent("el-scrollbar"),p=Vue.resolveComponent("el-col"),v=Vue.resolveComponent("el-row"),f=Vue.resolveComponent("el-table-column"),g=Vue.resolveComponent("el-input"),w=Vue.resolveComponent("el-switch"),_=Vue.resolveComponent("el-time-picker"),h=Vue.resolveComponent("el-date-picker"),y=Vue.resolveComponent("el-cascader"),k=Vue.resolveComponent("el-link"),b=Vue.resolveComponent("el-table"),C=Vue.resolveComponent("el-dialog");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(s,{type:"primary",class:"el-icon-s-operation",size:"default",onClick:a[0]||(a[0]=e=>t.visible=!0)},{default:Vue.withCtx(()=>[Vue.createTextVNode("筛选")]),_:1}),Vue.createVNode(C,{id:"search",title:"筛选",modelValue:t.visible,"onUpdate:modelValue":a[1]||(a[1]=e=>t.visible=e),"close-on-click-modal":!1,width:"40%"},{footer:Vue.withCtx(()=>[Vue.createElementVNode("span",_hoisted_1,[Vue.createVNode(s,{type:"primary",size:"default",onClick:d.search},{default:Vue.withCtx(()=>[Vue.createTextVNode("查询")]),_:1},8,["onClick"])])]),default:Vue.withCtx(()=>[Vue.createVNode(v,null,{default:Vue.withCtx(()=>[Vue.createVNode(p,{span:24},{default:Vue.withCtx(()=>[Vue.createVNode(i,{class:"ms-scrollbar",style:{height:"100%"}},{default:Vue.withCtx(()=>[Vue.createVNode(V,{"label-width":"120px",size:"default"},{default:Vue.withCtx(()=>[Vue.createVNode(m,{label:"添加筛选条件:"},{default:Vue.withCtx(()=>[Vue.createVNode(c,{onChange:d.select},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(d.availableOptions,(e,l)=>(Vue.openBlock(),Vue.createBlock(r,{key:e.index,value:l,label:e.name},null,8,["value","label"]))),128))]),_:1},8,["onChange"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),Vue.createVNode(b,{size:"default","show-header":!1,data:t.list,style:{width:"100%"}},{default:Vue.withCtx(()=>[Vue.createVNode(f,{prop:"name",width:"110"}),Vue.createVNode(f,{width:"130"},{default:Vue.withCtx(e=>[e.row.type=="input"||e.row.type=="textarea"?(Vue.openBlock(),Vue.createBlock(c,{key:0,modelValue:e.row.el,"onUpdate:modelValue":l=>e.row.el=l,size:"default"},{default:Vue.withCtx(()=>[Vue.createVNode(r,{label:"等于",value:"eq"}),Vue.createVNode(r,{label:"包含",value:"like"}),Vue.createVNode(r,{label:"不包含",value:"notLike"}),Vue.createVNode(r,{label:"为空",value:"empty"}),Vue.createVNode(r,{label:"不为空",value:"notempty"})]),_:2},1032,["modelValue","onUpdate:modelValue"])):Vue.createCommentVNode("",!0),e.row.type=="number"?(Vue.openBlock(),Vue.createBlock(c,{key:1,modelValue:e.row.el,"onUpdate:modelValue":l=>e.row.el=l,size:"default"},{default:Vue.withCtx(()=>[Vue.createVNode(r,{label:"大于",value:"gt"}),Vue.createVNode(r,{label:"小于",value:"lt"}),Vue.createVNode(r,{label:"等于",value:"eq"}),Vue.createVNode(r,{label:"不等于",value:"ne"}),Vue.createVNode(r,{label:"大于等于",value:"gte"}),Vue.createVNode(r,{label:"小于等于",value:"lte"})]),_:2},1032,["modelValue","onUpdate:modelValue"])):Vue.createCommentVNode("",!0),e.row.type=="date"||e.row.type=="time"?(Vue.openBlock(),Vue.createBlock(c,{key:2,modelValue:e.row.el,"onUpdate:modelValue":l=>e.row.el=l,size:"default",onChange:l=>d.dateChange(e.row)},{default:Vue.withCtx(()=>[Vue.createVNode(r,{label:"大于",value:"gt"}),Vue.createVNode(r,{label:"等于",value:"eq"}),Vue.createVNode(r,{label:"不等于",value:"ne"}),Vue.createVNode(r,{label:"小于",value:"lt"}),Vue.createVNode(r,{label:"范围",value:"range"}),Vue.createVNode(r,{label:"为空",value:"empty"}),Vue.createVNode(r,{label:"不为空",value:"notempty"})]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])):Vue.createCommentVNode("",!0),e.row.hasOwnProperty("multiple")||e.row.type=="switch"||e.row.type=="role"||e.row.type=="province_id"?(Vue.openBlock(),Vue.createBlock(c,{key:3,modelValue:e.row.el,"onUpdate:modelValue":l=>e.row.el=l,size:"default"},{default:Vue.withCtx(()=>[Vue.createVNode(r,{label:"等于",value:"eq"}),Vue.createVNode(r,{label:"为空",value:"empty"}),Vue.createVNode(r,{label:"不为空",value:"notempty"})]),_:2},1032,["modelValue","onUpdate:modelValue"])):Vue.createCommentVNode("",!0),e.row.type=="imgupload"||e.row.type=="imgdetail"?(Vue.openBlock(),Vue.createBlock(c,{key:4,modelValue:e.row.el,"onUpdate:modelValue":l=>e.row.el=l,size:"default"},{default:Vue.withCtx(()=>[Vue.createVNode(r,{label:"为空",value:"empty"}),Vue.createVNode(r,{label:"不为空",value:"notempty"})]),_:2},1032,["modelValue","onUpdate:modelValue"])):Vue.createCommentVNode("",!0)]),_:1}),Vue.createVNode(f,null,{default:Vue.withCtx(e=>[e.row.el!="empty"&&e.row.el!="notempty"?(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:0},[e.row.type=="input"||e.row.type=="number"||e.row.type=="textarea"?(Vue.openBlock(),Vue.createBlock(g,{key:0,style:{width:"200px"},modelValue:e.row.value,"onUpdate:modelValue":l=>e.row.value=l,size:"default",type:e.row.type==="number"?"number":"text"},null,8,["modelValue","onUpdate:modelValue","type"])):Vue.createCommentVNode("",!0),e.row.hasOwnProperty("multiple")&&e.row.type!=="cascader"?(Vue.openBlock(),Vue.createBlock(c,{key:1,style:{width:"200px"},modelValue:e.row.value,"onUpdate:modelValue":l=>e.row.value=l,size:"default",multiple:e.row.multiple},{default:Vue.withCtx(()=>[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(d.$searchParent[e.row.model+"Options"],l=>(Vue.openBlock(),Vue.createBlock(r,{key:l[e.row.key],value:l[e.row.key],label:l[e.row.title]},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","multiple"])):Vue.createCommentVNode("",!0),e.row.type=="switch"?(Vue.openBlock(),Vue.createBlock(w,{key:2,modelValue:e.row.value,"onUpdate:modelValue":l=>e.row.value=l},null,8,["modelValue","onUpdate:modelValue"])):Vue.createCommentVNode("",!0),e.row.type=="time"?(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:3},[e.row.el=="range"?(Vue.openBlock(),Vue.createBlock(_,{key:0,size:"default",clearable:"","is-range":"","value-format":"HH:mm:ss","range-separator":"至","start-placeholder":"请选择开始时间","end-placeholder":"请选择结束时间",modelValue:e.row.value,"onUpdate:modelValue":l=>e.row.value=l},null,8,["modelValue","onUpdate:modelValue"])):(Vue.openBlock(),Vue.createBlock(_,{key:1,size:"default",clearable:"","value-format":"HH:mm:ss",modelValue:e.row.value,"onUpdate:modelValue":l=>e.row.value=l},null,8,["modelValue","onUpdate:modelValue"]))],64)):Vue.createCommentVNode("",!0),e.row.type=="date"?(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:4},[e.row.fmt==="YYYY"?(Vue.openBlock(),Vue.createBlock(h,{key:0,size:"default",clearable:"","value-format":"YYYY",type:e.row.el==="range"?"yearrange":"year",modelValue:e.row.value,"onUpdate:modelValue":l=>e.row.value=l},null,8,["type","modelValue","onUpdate:modelValue"])):e.row.fmt==="YYYY-MM"?(Vue.openBlock(),Vue.createBlock(h,{key:1,size:"default",clearable:"","value-format":"YYYY-MM",type:e.row.el==="range"?"monthrange":"month",modelValue:e.row.value,"onUpdate:modelValue":l=>e.row.value=l},null,8,["type","modelValue","onUpdate:modelValue"])):e.row.fmt==="YYYY-MM-DD"?(Vue.openBlock(),Vue.createBlock(h,{key:2,size:"default",clearable:"","value-format":"YYYY-MM-DD",type:e.row.el==="range"?"daterange":"date",modelValue:e.row.value,"onUpdate:modelValue":l=>e.row.value=l},null,8,["type","modelValue","onUpdate:modelValue"])):(Vue.openBlock(),Vue.createBlock(h,{key:3,size:"default",clearable:"","value-format":"YYYY-MM-DD HH:mm:ss",type:e.row.el==="range"?"datetimerange":"datetime",modelValue:e.row.value,"onUpdate:modelValue":l=>e.row.value=l},null,8,["type","modelValue","onUpdate:modelValue"]))],64)):Vue.createCommentVNode("",!0),e.row.type==="province_id"||e.row.type==="cascader"?(Vue.openBlock(),Vue.createElementBlock(Vue.Fragment,{key:5},[e.row.type==="province_id"?(Vue.openBlock(),Vue.createBlock(y,{key:0,modelValue:e.row.value,"onUpdate:modelValue":l=>e.row.value=l,props:d.$searchParent[e.row.model+"Props"]},null,8,["modelValue","onUpdate:modelValue","props"])):e.row.type==="cascader"?(Vue.openBlock(),Vue.createBlock(y,{key:1,modelValue:e.row.value,"onUpdate:modelValue":l=>e.row.value=l,props:d.$searchParent[e.row.model+"Props"],options:d.cascaderTreeDatas(e.row)},null,8,["modelValue","onUpdate:modelValue","props","options"])):Vue.createCommentVNode("",!0)],64)):Vue.createCommentVNode("",!0)],64)):Vue.createCommentVNode("",!0)]),_:1}),Vue.createVNode(f,{align:"center",width:"130"},{default:Vue.withCtx(e=>[e.$index!=t.list.length-1?(Vue.openBlock(),Vue.createBlock(c,{key:0,modelValue:e.row.action,"onUpdate:modelValue":l=>e.row.action=l,size:"default"},{default:Vue.withCtx(()=>[Vue.createVNode(r,{label:"与",value:"and"}),Vue.createVNode(r,{label:"或",value:"or"})]),_:2},1032,["modelValue","onUpdate:modelValue"])):Vue.createCommentVNode("",!0)]),_:1}),Vue.createVNode(f,{align:"center",width:"60"},{default:Vue.withCtx(e=>[Vue.createVNode(k,{type:"primary",underline:!1,onClick:l=>d.delField(e.$index)},{default:Vue.withCtx(()=>[Vue.createTextVNode("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"])])}const MsSearch=_export_sfc(_sfc_main,[["render",_sfc_render],["__scopeId","data-v-2a385fa6"]]),components=[MsIcon,MsMdiyForm,MsSearch],install=(t,a)=>{components.forEach(n=>{n.install=u=>{u.component(n.name,n),a&&a.debug},t.use((n.name,n))})},index={install};exports.MsIcon=MsIcon,exports.MsMdiyForm=MsMdiyForm,exports.MsSearch=MsSearch,exports.default=index,exports.install=install,Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
