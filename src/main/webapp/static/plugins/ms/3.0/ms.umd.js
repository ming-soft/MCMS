(function(c,f){typeof exports=="object"&&typeof module<"u"?f(exports,require("axios"),require("qs"),require("element-plus")):typeof define=="function"&&define.amd?define(["exports","axios","qs","element-plus"],f):(c=typeof globalThis<"u"?globalThis:c||self,f(c.ms={},c.axios,c.Qs))})(this,function(c,f,E){"use strict";let b=!1,w=null;function S(t){if(t!=null){var n=f.create({baseURL:t.baseURL==null?f.defaults.baseURL:t.baseURL,timeout:t.timeout==null?f.defaults.timeout:t.timeout,headers:t.headers==null?null:t.headers});return n.interceptors.response.use(function(e){return e},function(e){if(e.response){let i;if(e.response.status==401?i="登录超时":e.response.status==400?i="客户端错误":e.response.status==403?i="您的权限不足":e.response.status==423?i="账号被锁定！":e.response.status==500?i="服务器异常,请刷新页面重试！":e.response.status==501?i="您的操作被取消或不允许提交,请刷新页面重试！":e.response.status==423?i="服务器正在开小差,请刷新页面重试！":e.response.status==404&&(i="资源不存在,请刷新页面重试！"),i){if(!o){var o=document.createElement("div");o.id="tempVue",document.body.appendChild(o)}ElementPlus.ElNotification.error({title:"系统提示",message:e.response.data.msg||i,duration:3e3}),e.response.status==401&&!b&&(sessionStorage.removeItem("ACCESS_TOKEN"),b=!0,w&&window.ms.login&&!window.ms.login.includes(window.location.hash)&&(w.abort(),w=null),window.ms.login&&(b=!1,window.location.href=window.ms.login))}return Promise.reject(e)}else{if(f.isCancel(e))return Promise.resolve(e);ElementPlus.ElNotification.error({title:"系统提示",message:"不能请求到服务器，请检查网络是否正常或系统是否正常运行！",duration:3e3})}}),n.interceptors.request.use(function(e){if(b){const o=new AbortController;e.signal=o.signal,o.abort()}else w||(w=new AbortController),e.signal=w.signal;return e.headers||(e.headers={}),e.headers=Object.assign(e.headers,{"Cache-Control":"no-cache",Pragma:"no-cache","X-Requested-With":"XMLHttpRequest"}),sessionStorage.getItem("token")!=""&&(e.headers.token=sessionStorage.getItem("token")),e.method==="post"&&e.headers["Content-Type"]==="application/x-www-form-urlencoded"&&(e.data=E.stringify(e.data,{allowDots:!0})),e},function(e){return Promise.reject(e)}),n}return f}function D(t,n,e){return n==null&&(n={}),e==null&&(e={headers:{"X-Requested-With":"XMLHttpRequest"}}),new Promise(function(o,i){S(e).get(t,{params:n},e).then(function(r){o(r?r.data:void 0)}).catch(function(r){i(r)})})}function R(t,n,e){return n==null&&(n={}),e==null&&(e={headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"}}),new Promise(function(o,i){S(e).post(t,n,e).then(function(r){o(r.data?r.data:void 0)},function(r){i(r)})})}function x(t,n,e){return n==null&&(n={}),new Promise(function(o,i){S(e).patch(t,n,e).then(function(r){o(r)},function(r){i(r)})})}function P(t,n,e){return n==null&&(n={}),new Promise(function(o,i){S(e).put(t,n,e).then(function(r){o(r.data)},function(r){i(r)})})}function C(t,n,e,o){return n==null&&(n={}),new Promise(function(i,r){f({method:"post",url:t,data:n,timeout:e||1e3*60*5,responseType:"blob",headers:{Accept:"application/vnd.openxmlformats-officedocument"},onDownloadProgress:function(s){o&&o(s)}}).then(function(s){const p=s.data,u=new Blob([p]),m=s.headers["content-disposition"].split(";"),g=m[2].slice(11,m[2].length-1);if("download"in document.createElement("a")){const a=document.createElement("a");a.download=g,a.style.display="none",a.href=URL.createObjectURL(u),document.body.appendChild(a),a.click(),URL.revokeObjectURL(a.href),document.body.removeChild(a)}else navigator.msSaveBlob(u,g);i(s)},function(s){r(s)})})}const O={get:D,post:R,put:P,patch:x,download:C};function F(t,n){n?t.indexOf("?")>0?window.location.href=ms.manager+t+"&isBack="+n:window.location.href=ms.manager+t+"?isBack="+n:window.location.href=ms.manager+t}function I(t){try{var n=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),e=window.location.search.substr(1).match(n);return e!=null?decodeURI(e[2]):null}catch(o){X(o.message)}}function q(t,n,e,o){var i=JSON.parse(JSON.stringify(t));return i.filter(function(r){var s=i.filter(function(p){return r[n]==p[e]});return s.length>0&&(r[o]=s),!r[e]||r[e]=="0"||r[e]==null})}function M(t,n,e,o,i){var r=t.find(function(s){return s[o]==e});return r&&r[i]!=="0"&&r[i]?n==r[i]?!1:M(t,n,r[i],o,i):!0}function L(t){return accounting.formatMoney(t,"¥",2)}var T={fmt:function(t,n){var e;e=new Date(typeof t=="string"?t.replace(/-/g,"/"):t),e instanceof Date&&isNaN(e.getTime())&&(e=moment(t,n).toDate()),n=n.replaceAll("Y","y").replaceAll("D","d"),n||(n="yyyy-MM-dd");var o={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"H+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(n)&&(n=n.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in o)new RegExp("("+i+")").test(n)&&(n=n.replace(RegExp.$1,RegExp.$1.length==1?o[i]:("00"+o[i]).substr((""+o[i]).length)));return n},diyFmt:function(t){Object.prototype.toString.call(new Date)!==Object.prototype.toString.call(t)&&(t=new Date(t));var n=new Date().getTime(),e=(n-t)/1e3,o="";return e<60?o="刚刚":e<3600?o=moment(t).format("A")+moment(t).format("H:mm"):e<86400?o="昨天":e<172800?o=moment(t).format("dddd"):e<31536e3?o=moment(t).format("MMM Do").replace(" ",""):o=moment(t).subtract(10,"days").calendar(),o}},N={unique:function(t,n){if(t.length!=0){for(var e=[t[0]],o=1;o<t.length;o++){for(var i=t[o],r=!1,s=0;s<e.length;s++)if(i[n]==e[s][n]){if(i.write&&e[s].write==!1)break;r=!0;break}r||e.push(i)}return e}}},U={byte:function(t){if(isNaN(t))return"";var n=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],e=Math.floor(Math.log(t)/Math.log(2));e<1&&(e=0);var o=Math.floor(e/10);return t=t/Math.pow(2,10*o),t.toString().length>t.toFixed(2).toString().length&&(t=t.toFixed(2)),t+" "+n[o]},distance:function(t,n,e,o){var i=3.14159265359,r=6.28318530712,s=.01745329252,p=63706935e-1,u,m,g,a,h,l,d,v;return u=t*s,m=n*s,g=e*s,a=o*s,d=u-g,d>i?d=r-d:d<-i&&(d=r+d),h=p*Math.cos(m)*d,l=p*(m-a),v=Math.sqrt(h*h+l*l).toFixed(0),v}};function X(t){window.ms.debug}var A={set:function(t,n){window.sessionStorage.setItem(t,n)},get:function(t){return window.sessionStorage.getItem(t)},remove:function(t){window.sessionStorage.removeItem(t)}};function B(t,n,e,o){var i=XLSX.utils.table_to_book(t),r=[],s=[],p=[];o.column.forEach(function(a){p.push(a.label),r.push({wpx:a.width})}),s.push(p);var u=new Array(o.column.length);e.map(function(a){var h=[];return o.column.forEach(function(l){if(a.hasOwnProperty(l.filed))if(l.dictDataOptions!=null&&l.dictDataOptions.length>0){var d=l.dictDataOptions.find(function(v){return a[l.filed]==v.dictValue});h.push(d?d.dictLabel:"")}else h.push(a[l.filed]),o.countFiled!=null&&o.countFiled.indexOf(l.filed)>=0&&(u[0]="总计",o.column.findIndex(function(v,y){v.filed==l.filed&&(u[y]=u[y]==null?a[l.filed]:u[y]+a[l.filed])}));else h.push("")}),h}).forEach(function(a,h){s.push(a)}),s.push(u);var m=XLSX2.utils.aoa_to_sheet(s);i.Sheets.Sheet1=m,i.Sheets.Sheet1["!cols"]=r;var g=XLSX.write(i,{bookType:"xlsx",bookSST:!0,type:"array"});try{saveAs(new Blob([g],{type:"application/octet-stream"}),n+".xlsx")}catch{}return g}function _(t,n){t!==""&&t!=null&&t!=null&&ms.http.get(ms.manager+"/mprint/printTemplate/get.do",{name:t}).then(function(e){n!=null&&n!=null&&e.data!=null&&printVue.open(e.data,n)}).catch(function(e){})}function j(t){const n=t.toLowerCase().split("_");for(let e=1;e<n.length;e++)n[e]=n[e].charAt(0).toUpperCase()+n[e].slice(1);return n.join("")}function H(){var t=navigator,n=t.appVersion,e=n.split(";"),o=e[1].replace(/[ ]/g,"");if(t.appName=="Microsoft Internet Explorer"){if(o.indexOf("MSIE")>-1&&o!=="MSIE10.0")return"MSIE9.0";if(o.indexOf("MSIE10.0")>-1)return"MSIE10.0"}else return"other"}function k(t,n){return t&&t.includes(n)||!1}const V={browserVersion:H,getParameter:I,treeData:q,childValidate:M,moneyFormatter:L,openSystemUrl:F,date:T,array:N,convert:U,store:A,exportTable:B,printFile:_,camelCaseString:j,includes:k};c.http=O,c.util=V,Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});
